<!DOCTYPE html>
<html>
<head>
    <link rel="shortcut icon" type="image/x-icon" href="/internal/gui/ico.png">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
    <meta http-equiv="Pragma" content="no-cache" />
    <meta http-equiv="Expires" content="0" />
    <style>
        .dropbtn {
            background-color: #3498DB;
            color: white;
            padding: 16px;
            font-size: 16px;
            border: none;
            cursor: pointer;
        }

        .dropbtn:hover, .dropbtn:focus {
            background-color: #2980B9;
        }

        .datasetDropdownHolder {
            position: relative;
            display: inline-block;
        }

        .dropdown-content {
            display: none;
            position: absolute;
            background-color: #f1f1f1;
            min-width: 160px;
            overflow: auto;
            box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
            z-index: 1;
        }

        .dropdown-content a {
            color: black;
            padding: 12px 16px;
            text-decoration: none;
            display: block;
        }

        a:hover {background-color: #ddd}

        .show {display: block;}

        table.blueTable {
            border: 1px solid #1C6EA4;
            background-color: #EEEEEE;
            width: 100%;
            text-align: left;
            border-collapse: collapse;
        }
        table.blueTable td, table.blueTable th {
            border: 1px solid #AAAAAA;
            padding: 3px 2px;
        }
        table.blueTable tbody td {
            font-size: 13px;
        }
        table.blueTable tr:nth-child(even) {
            background: #D0E4F5;
        }
        table.blueTable thead {
            background: #1C6EA4;
            background: -moz-linear-gradient(top, #5592bb 0%, #327cad 66%, #1C6EA4 100%);
            background: -webkit-linear-gradient(top, #5592bb 0%, #327cad 66%, #1C6EA4 100%);
            background: linear-gradient(to bottom, #5592bb 0%, #327cad 66%, #1C6EA4 100%);
            border-bottom: 2px solid #444444;
        }
        table.blueTable thead th {
            font-size: 15px;
            font-weight: bold;
            color: #FFFFFF;
            border-left: 2px solid #D0E4F5;
        }
        table.blueTable thead th:first-child {
            border-left: none;
        }

        table.blueTable tfoot {
            font-size: 14px;
            font-weight: bold;
            color: #FFFFFF;
            background: #D0E4F5;
            background: -moz-linear-gradient(top, #dcebf7 0%, #d4e6f6 66%, #D0E4F5 100%);
            background: -webkit-linear-gradient(top, #dcebf7 0%, #d4e6f6 66%, #D0E4F5 100%);
            background: linear-gradient(to bottom, #dcebf7 0%, #d4e6f6 66%, #D0E4F5 100%);
            border-top: 2px solid #444444;
        }
        table.blueTable tfoot td {
            font-size: 14px;
        }
        table.blueTable tfoot .links {
            text-align: right;
        }
        table.blueTable tfoot .links a{
            display: inline-block;
            background: #1C6EA4;
            color: #FFFFFF;
            padding: 2px 8px;
            border-radius: 5px;
        }
    </style>
</head>
<body>

<h2>Henvendelse table examine</h2>
<div id="table-container">
    <!-- Records will be loaded here dynamically -->
</div>

<div id="pagination">
    <button onclick="loadPreviousPage()">Previous</button>
    <span id="currentPage"></span>
    <button onclick="loadNextPage()">Next</button>
</div>
<div id="report"></div>
<br>
<div id="testreport"></div>

<table class="blueTable">
    <thead>
    <tr>
        <th>head1</th>
        <th>head2</th>
        <th>head3</th>
        <th>head4</th>
    </tr>
    </thead>
    <tfoot>
    <tr>
        <td colspan="4">
            <div class="links"><a href="#">&laquo;</a> <a class="active" href="#">1</a> <a href="#">2</a> <a href="#">3</a> <a href="#">4</a> <a href="#">&raquo;</a></div>
        </td>
    </tr>
    </tfoot>
    <tbody>
    <tr>
        <td>cell1_1</td>
        <td>cell2_1</td>
        <td>cell3_1</td>
        <td>cell4_1</td>
    </tr>
    <tr>
        <td>cell1_2</td>
        <td>cell2_2</td>
        <td>cell3_2</td>
        <td>cell4_2</td>
    </tr>
    <tr>
        <td>cell1_3</td>
        <td>cell2_3</td>
        <td>cell3_3</td>
        <td>cell4_3</td>
    </tr>
    <tr>
        <td>cell1_4</td>
        <td>cell2_4</td>
        <td>cell3_4</td>
        <td>cell4_4</td>
    </tr>
    </tbody>
</table>

<script>
    let currentPage = 1;
    let pageSize = 1;
    let count = 0;
    let pageCount = 1

    window.onload = function() {
        console.log("Do on load");
        loadTablePage(currentPage);
    };

    const loadTablePage = async (page) => {
        const response = await fetch('/internal/view?page=' + page, {
            method: 'GET',
            headers: {
                'Content-Type': 'application/json'
            }
        });


        const data = await response.json();
        const records = data.records;
        currentPage = data.page
        pageCount = data.pageCount
        pageSize = data.pageSize
        count = data.count
        // Display records in a table
        const tableContainer = document.getElementById('table-container');

        tableContainer.innerHTML = '<table class="blueTable">' +
            '<thead><tr><th>ID</th><th>Aktor ID</th><th>JSON</th><th>Last Modified</th><th>Last Modified By SF</th></tr></thead><tbody>' +
            records.map(record =>
                `<tr>
                    <td>${record.id}</td>
                    <td>${record.aktorid}</td>
                    <td>${record.json}</td>
                    <td>${record.lastModified}</td>
                    <td>${record.lastModifiedBySF}</td>
                </tr>`
            ).join('') +
            '</tbody></table>';

        // Update current page information
        const currentPageElement = document.getElementById('currentPage');
        currentPageElement.textContent = `Page ${currentPage} of ${pageCount} (showing ${pageSize} of ${count} records)`;
    };

    const loadPreviousPage = () => {
        if (currentPage > 1) {
            loadTablePage(currentPage - 1);
        }
    };

    const loadNextPage = () => {
        // You should check if there are more pages before loading the next one
        if (currentPage < pageCount) {
            loadTablePage(currentPage + 1);
        }
    };

    const loadTablePageOld = async ( page ) => {
        const response = await fetch('/internal/view?page='+page, {
            method: 'GET',
            headers: {
                'Content-Type': 'text/html'
            }
        });

        var h = await response.text();

        let dst = document.body

        dst.innerHTML = dst.innerHTML + h
    }
</script>

</body>
</html>